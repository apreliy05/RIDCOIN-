<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RIDCOIN - –ò–≥—Ä–∞ Beekeeper</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            background: #333;
            padding: 20px;
            border-radius: 10px;
        }
        .game-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .resource {
            background: #444;
            padding: 10px;
            border-radius: 5px;
            margin: 5px;
        }
        .apiary {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .hive {
            background: #555;
            border: 2px solid #f39c12;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
        }
        .hive.selected {
            background: #3a3a3a;
            box-shadow: 0 0 10px #f39c12;
        }
        .btn {
            background: #f39c12;
            color: white;
            border: none;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn:disabled {
            background: #666;
            cursor: not-allowed;
        }
        .events-log {
            height: 200px;
            overflow-y: auto;
            background: #222;
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2d572c;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1>Beekeeper</h1>
            <div>
                <div class="resource">üçØ –ú—ë–¥: <span id="honey-count">0</span></div>
                <div class="resource">ü™ô –ú–æ–Ω–µ—Ç—ã: <span id="coins-count">100</span></div>
            </div>
        </div>
        
        <div class="apiary" id="apiary">
            <!-- –£–ª—å–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
        
        <div>
            <button class="btn" id="buy-hive">–ö—É–ø–∏—Ç—å —É–ª–µ–π (50 ü™ô)</button>
            <button class="btn" id="collect-honey" disabled>–°–æ–±—Ä–∞—Ç—å –º—ë–¥</button>
            <button class="btn" id="sell-honey" disabled>–ü—Ä–æ–¥–∞—Ç—å –º—ë–¥ (10 ü™ô/üçØ)</button>
            <button class="btn" id="upgrade-hive" disabled>–£–ª—É—á—à–∏—Ç—å —É–ª–µ–π (100 ü™ô)</button>
        </div>
        
        <div class="events-log" id="game-events">
            <div>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–≥—Ä—É Beekeeper!</div>
        </div>
    </div>

    <div class="notification" id="notification">–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!</div>

    <script>
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        const gameState = {
            honey: 0,
            coins: 100,
            hives: [],
            selectedHive: null,
            hivePrice: 50,
            honeyPrice: 10,
            upgradePrice: 100,
            lastSave: Date.now()
        };

        // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const elements = {
            apiary: document.getElementById('apiary'),
            honeyCount: document.getElementById('honey-count'),
            coinsCount: document.getElementById('coins-count'),
            buyHive: document.getElementById('buy-hive'),
            collectHoney: document.getElementById('collect-honey'),
            sellHoney: document.getElementById('sell-honey'),
            upgradeHive: document.getElementById('upgrade-hive'),
            gameEvents: document.getElementById('game-events'),
            notification: document.getElementById('notification')
        };

        // –ö–ª—é—á –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        const SAVE_KEY = 'beekeeper_save';

        // –§—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã
        function addEvent(message) {
            const now = new Date();
            const time = `[${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}]`;
            const eventElement = document.createElement('div');
            eventElement.innerHTML = `<strong>${time}</strong> ${message}`;
            elements.gameEvents.prepend(eventElement);
            
            if (elements.gameEvents.children.length > 20) {
                elements.gameEvents.removeChild(elements.gameEvents.lastChild);
            }
        }

        function showNotification(message) {
            elements.notification.textContent = message;
            elements.notification.style.display = 'block';
            setTimeout(() => {
                elements.notification.style.display = 'none';
            }, 2000);
        }

        function updateUI() {
            elements.honeyCount.textContent = gameState.honey;
            elements.coinsCount.textContent = gameState.coins;
            
            elements.buyHive.textContent = `–ö—É–ø–∏—Ç—å —É–ª–µ–π (${gameState.hivePrice} ü™ô)`;
            elements.buyHive.disabled = gameState.coins < gameState.hivePrice;
            
            elements.sellHoney.disabled = gameState.honey < 1;
            elements.collectHoney.disabled = gameState.selectedHive === null;
            elements.upgradeHive.disabled = gameState.selectedHive === null || gameState.coins < gameState.upgradePrice;
        }

        function renderHives() {
            elements.apiary.innerHTML = '';
            
            if (gameState.hives.length === 0) {
                elements.apiary.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:20px;">–ö—É–ø–∏—Ç–µ –ø–µ—Ä–≤—ã–π —É–ª–µ–π</div>';
                return;
            }
            
            gameState.hives.forEach((hive, index) => {
                const hiveElement = document.createElement('div');
                hiveElement.className = `hive ${gameState.selectedHive === index ? 'selected' : ''}`;
                hiveElement.innerHTML = `
                    <div style="font-size:24px;">üêù</div>
                    <div>–£–ª–µ–π #${index + 1}</div>
                    <div>–£—Ä–æ–≤–µ–Ω—å ${hive.level}</div>
                `;
                
                hiveElement.addEventListener('click', () => {
                    gameState.selectedHive = index;
                    renderHives();
                    updateUI();
                    addEvent(`–í—ã–±—Ä–∞–Ω —É–ª–µ–π #${index + 1}`);
                });
                
                elements.apiary.appendChild(hiveElement);
            });
        }

        function produceHoney() {
            gameState.hives.forEach((hive, index) => {
                const produced = hive.level * 0.5;
                gameState.honey += produced;
                if (produced > 0) {
                    addEvent(`–£–ª–µ–π #${index + 1} –ø—Ä–æ–∏–∑–≤–µ–ª ${produced.toFixed(1)} üçØ`);
                }
            });
            updateUI();
        }

        // –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        function saveGame() {
            gameState.lastSave = Date.now();
            localStorage.setItem(SAVE_KEY, JSON.stringify(gameState));
            showNotification('–ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!');
        }

        function loadGame() {
            const savedData = localStorage.getItem(SAVE_KEY);
            if (savedData) {
                try {
                    const savedState = JSON.parse(savedData);
                    
                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
                    gameState.honey = savedState.honey || 0;
                    gameState.coins = savedState.coins || 100;
                    gameState.hives = savedState.hives || [];
                    gameState.hivePrice = savedState.hivePrice || 50;
                    gameState.upgradePrice = savedState.upgradePrice || 100;
                    gameState.selectedHive = savedState.selectedHive !== undefined ? savedState.selectedHive : null;
                    
                    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –æ—Ñ—Ñ–ª–∞–π–Ω-–ø—Ä–æ–¥—É–∫—Ü–∏—é
                    const offlineTime = Date.now() - (savedState.lastSave || Date.now());
                    if (offlineTime > 5000) { // –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –±–æ–ª—å—à–µ 5 —Å–µ–∫—É–Ω–¥
                        const offlineHours = offlineTime / (1000 * 60 * 60); // –í —á–∞—Å–∞—Ö
                        const maxOfflineHours = 24; // –ú–∞–∫—Å–∏–º—É–º 24 —á–∞—Å–∞
                        const effectiveHours = Math.min(offlineHours, maxOfflineHours);
                        
                        let offlineHoney = 0;
                        gameState.hives.forEach(hive => {
                            offlineHoney += hive.level * effectiveHours;
                        });
                        
                        gameState.honey += Math.floor(offlineHoney);
                        addEvent(`–ó–∞ –≤—Ä–µ–º—è –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è: +${Math.floor(offlineHoney)} üçØ`);
                    }
                    
                    addEvent("–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞");
                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:", e);
                    addEvent("–ù–æ–≤–∞—è –∏–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞");
                }
            } else {
                addEvent("–ù–æ–≤–∞—è –∏–≥—Ä–∞ –Ω–∞—á–∞—Ç–∞");
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        elements.buyHive.addEventListener('click', () => {
            if (gameState.coins >= gameState.hivePrice) {
                gameState.coins -= gameState.hivePrice;
                gameState.hives.push({ level: 1 });
                gameState.hivePrice = Math.floor(gameState.hivePrice * 1.2);
                
                if (gameState.hives.length === 1) {
                    gameState.selectedHive = 0;
                    addEvent("–ü–µ—Ä–≤—ã–π —É–ª–µ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞–Ω");
                }
                
                addEvent(`–ö—É–ø–ª–µ–Ω –Ω–æ–≤—ã–π —É–ª–µ–π –∑–∞ ${gameState.hivePrice} ü™ô`);
                renderHives();
                updateUI();
                saveGame();
            }
        });

        elements.collectHoney.addEventListener('click', () => {
            if (gameState.selectedHive !== null) {
                const collected = gameState.hives[gameState.selectedHive].level * 2;
                gameState.honey += collected;
                addEvent(`–°–æ–±—Ä–∞–Ω–æ ${collected} üçØ —Å —É–ª—å—è #${gameState.selectedHive + 1}`);
                updateUI();
                saveGame();
            }
        });

        elements.sellHoney.addEventListener('click', () => {
            if (gameState.honey > 0) {
                const earned = gameState.honey * gameState.honeyPrice;
                gameState.coins += earned;
                addEvent(`–ü—Ä–æ–¥–∞–Ω–æ ${gameState.honey} üçØ –∑–∞ ${earned} ü™ô`);
                gameState.honey = 0;
                updateUI();
                saveGame();
            }
        });

        elements.upgradeHive.addEventListener('click', () => {
            if (gameState.selectedHive !== null && gameState.coins >= gameState.upgradePrice) {
                const hive = gameState.hives[gameState.selectedHive];
                gameState.coins -= gameState.upgradePrice;
                hive.level += 1;
                gameState.upgradePrice = Math.floor(gameState.upgradePrice * 1.5);
                
                addEvent(`–£–ª–µ–π #${gameState.selectedHive + 1} —É–ª—É—á—à–µ–Ω –¥–æ —É—Ä–æ–≤–Ω—è ${hive.level}`);
                renderHives();
                updateUI();
                saveGame();
            }
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            loadGame();
            updateUI();
            renderHives();
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –º—ë–¥–∞
            setInterval(() => {
                produceHoney();
                // –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
                if (Math.random() < 0.1) saveGame();
            }, 3000);
            
            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            window.addEventListener('beforeunload', saveGame);
        }

        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        window.onload = initGame;
    </script>
</body>
</html>